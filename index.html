<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>GeoNotify - Tourist Safety System</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />

  <style>
    * {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #e6f7e6;
    }

    header {
      background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
      color: white;
      padding: 20px;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }

    h1 {
      margin: 0;
      font-size: 2rem;
    }

    header p {
      font-size: 0.95rem;
      margin: 5px 0 15px;
      opacity: 0.9;
    }

    #user-info {
      display: inline-block;
      padding: 8px 15px;
      border-radius: 20px;
      margin: 10px 0 5px;
      background: rgba(255, 255, 255, 0.2);
    }

    #auth-buttons {
      margin-top: 10px;
    }

    #auth-buttons button {
      margin: 0 5px;
      padding: 8px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }

    .btn-primary {
      background: #fff;
      color: #4CAF50;
    }

    .btn-primary:hover {
      background: #f0f0f0;
    }

    .btn-secondary {
      background: transparent;
      color: #fff;
      border: 2px solid #fff !important;
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .btn-logout {
      background: #e74c3c;
      color: white;
    }

    .btn-logout:hover {
      background: #c0392b;
    }

    #map {
      height: 65vh;
      width: 92%;
      margin: 15px auto;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .panel {
      position: absolute;
      left: 15px;
      top: 120px;
      z-index: 1000;
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      width: 260px;
      max-height: 70vh;
      overflow-y: auto;
    }

    .panel h3 {
      margin: 0 0 15px 0;
      padding-bottom: 10px;
      border-bottom: 2px solid #4CAF50;
      font-size: 1.1rem;
    }

    .panel input,
    .panel textarea {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ddd;
      font-family: inherit;
    }

    .panel textarea {
      resize: vertical;
      min-height: 60px;
    }

    .panel button {
      width: 100%;
      margin-bottom: 8px;
      padding: 10px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }

    .panel button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    #admin-controls button,
    #tourist-controls button {
      background: #4CAF50;
      color: white;
    }

    #admin-controls button:hover,
    #tourist-controls button:hover {
      background: #45a049;
    }

    #rescue-controls {
      background: #ffe6e6;
      padding: 15px;
      border-radius: 8px;
    }

    .btn-small {
      padding: 5px 10px !important;
      width: auto !important;
      display: inline-block !important;
      margin: 5px 5px 0 0 !important;
      font-size: 0.85rem;
    }

    .btn-delete {
      background: #e74c3c !important;
      color: white !important;
    }

    .btn-delete:hover {
      background: #c0392b !important;
    }

    #status {
      font-size: 13px;
      color: #555;
      margin-top: 10px;
      padding: 8px;
      background: #f0f0f0;
      border-radius: 5px;
    }

    .info-box {
      background: #fff;
      padding: 20px;
      margin: 15px auto;
      width: 92%;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .info-box h3 {
      margin-top: 0;
      color: #4CAF50;
    }

    .info-box ul {
      line-height: 1.8;
    }

    .danger-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      padding: 15px;
    }

    .danger-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      padding: 8px 15px;
      background: #f9f9f9;
      border-radius: 5px;
    }

    .danger-box {
      width: 24px;
      height: 24px;
      border-radius: 4px;
    }

    /* Modal Styles */
    #auth-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    }

    #modal-title {
      margin: 0 0 20px 0;
      color: #4CAF50;
      font-size: 1.5rem;
      border-bottom: 2px solid #4CAF50;
      padding-bottom: 10px;
    }

    #modal-content input,
    #modal-content textarea {
      width: 100%;
      padding: 12px;
      margin-bottom: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
    }

    #modal-content button {
      padding: 12px 24px;
      margin: 5px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1rem;
      transition: 0.3s;
    }

    #modal-content .btn-primary {
      background: #4CAF50;
      color: white;
    }

    #modal-content .btn-primary:hover {
      background: #45a049;
    }

    #modal-content .btn-secondary {
      background: #ccc;
      color: #333;
    }

    #modal-content .btn-secondary:hover {
      background: #bbb;
    }

    #modal-content h4 {
      margin: 20px 0 10px 0;
      color: #333;
    }

    .role-selector {
      margin: 15px 0;
    }

    .role-option {
      display: block;
      padding: 12px;
      margin: 8px 0;
      border: 2px solid #ddd;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }

    .role-option:hover {
      border-color: #4CAF50;
      background: #f9f9f9;
    }

    .role-option input[type="radio"] {
      margin-right: 10px;
    }

    .role-option span {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
    }

    .role-option small {
      color: #666;
    }

    .alert-card {
      background: #fff3cd;
      border-left: 4px solid #e74c3c;
      padding: 15px;
      margin: 10px 0;
      border-radius: 5px;
    }

    .alert-card h5 {
      margin: 0 0 10px 0;
      color: #e74c3c;
    }

    .alert-card p {
      margin: 5px 0;
      font-size: 0.9rem;
    }

    footer {
      background: #4CAF50;
      color: white;
      text-align: center;
      padding: 15px;
      margin-top: 20px;
    }

    @media (max-width: 768px) {
      .panel {
        width: calc(100% - 30px);
        left: 15px;
        top: 100px;
      }

      #map {
        height: 50vh;
      }

      .modal-content {
        width: 95%;
        padding: 20px;
      }
    }
  </style>
</head>

<body>

  <header>
    <h1>üåø GeoNotify - Tourist Safety System</h1>
    <p>Real-time geofencing with automatic rescue team alerts</p>
    <div id="user-info"><em>Not logged in</em></div>
    <div id="auth-buttons"></div>
  </header>

  <div class="info-box danger-legend">
    <div class="danger-item">
      <div class="danger-box" style="background:#007bff;"></div>
      <span>‚úÖ Safe</span>
    </div>
    <div class="danger-item">
      <div class="danger-box" style="background:#FFFF00;"></div>
      <span>‚ö° Caution</span>
    </div>
    <div class="danger-item">
      <div class="danger-box" style="background:#FFA500;"></div>
      <span>‚ö†Ô∏è Warning</span>
    </div>
    <div class="danger-item">
      <div class="danger-box" style="background:#FF0000;"></div>
      <span>‚ö†Ô∏è Danger</span>
    </div>
    <div class="danger-item">
      <div class="danger-box" style="background:#8B0000;"></div>
      <span>üö® Critical</span>
    </div>
  </div>

  <div id="map"></div>

  <!-- Admin Controls Panel -->
  <div class="panel" id="admin-controls" style="display:none;">
    <h3>üëë Admin Controls</h3>
    <input id="name" placeholder="Geofence name *" />
    <textarea id="description" placeholder="Description (optional)"></textarea>
    <textarea id="reminder" placeholder="Safety reminder (optional)"></textarea>
    <button id="draw-start">‚úèÔ∏è Start Drawing</button>
    <button id="save">üíæ Save Geofence</button>
    <button id="load">üîÑ Reload Zones</button>
    <small style="color:#666; display:block; margin-top:10px;">
      Click map to add points. Need ‚â•3 points to save.
    </small>
  </div>

  <!-- Tourist Controls Panel -->
  <div class="panel" id="tourist-controls" style="display:none;">
    <h3>üß≥ Tourist Controls</h3>
    <button id="load">üîÑ Reload Zones</button>
    <button id="watch">‚ñ∂Ô∏è Start Watch</button>
    <button id="my-location">üìç My Location</button>
    <div id="status"></div>
  </div>

  <!-- Rescue Team Panel -->
  <div class="panel" id="rescue-controls" style="display:none;">
    <h3>üöì Rescue Team Dashboard</h3>
    <div id="rescue-dashboard">
      <p>Loading alerts...</p>
    </div>
    <button id="load" style="background:#4CAF50; color:white;">üîÑ Reload Zones</button>
    <button id="my-location" style="background:#1976D2; color:white;">üìç My Location</button>
  </div>

  <!-- Auth Modal -->
  <div id="auth-modal">
    <div class="modal-content">
      <h2 id="modal-title"></h2>
      <div id="modal-content"></div>
    </div>
  </div>

  <div class="info-box">
    <h3>‚ÑπÔ∏è How GeoNotify Works</h3>
    <ul>
      <li><strong>üëë Admin:</strong> Create and manage geofenced zones. Set danger levels and configure automatic rescue
        alerts.</li>
      <li><strong>üß≥ Tourist:</strong> Register, login, and subscribe to safety zones. Receive real-time alerts when
        entering danger areas.</li>
      <li><strong>üöì Rescue Team:</strong> Monitor active danger alerts. Receive automatic notifications when tourists
        enter critical zones.</li>
      <li><strong>üö® Auto-Rescue:</strong> Critical and danger zones automatically notify the rescue team with tourist
        location and emergency contacts.</li>
      <li><strong>üìç Real-time Tracking:</strong> Continuous location monitoring with distance-based proximity alerts.
      </li>
    </ul>
  </div>

  <footer>
    &copy; 2025 GeoNotify - Tourist Safety System | Powered by OpenStreetMap
  </footer>

  <!-- Scripts -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
  <script src="app.js"></script>
</body>

</html>
